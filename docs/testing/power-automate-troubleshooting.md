---
title: Dépannage Office scripts en cours d’exécution Power Automate
description: Astuces, informations de plate-forme, et les problèmes connus avec l’intégration entre Office scripts et Power Automate.
ms.date: 05/17/2021
localization_priority: Normal
ms.openlocfilehash: e26378051c764d97b4e8d748abc85fbe095c7b03
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545568"
---
# <a name="troubleshoot-office-scripts-running-in-power-automate"></a><span data-ttu-id="9e90c-103">Dépannage Office scripts en cours d’exécution Power Automate</span><span class="sxs-lookup"><span data-stu-id="9e90c-103">Troubleshoot Office Scripts running in Power Automate</span></span>

<span data-ttu-id="9e90c-104">Power Automate vous permet de passer Office l’automatisation du script au niveau suivant.</span><span class="sxs-lookup"><span data-stu-id="9e90c-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="9e90c-105">Toutefois, comme Power Automate exécute des scripts en votre nom dans des sessions Excel, il y a quelques choses importantes à noter.</span><span class="sxs-lookup"><span data-stu-id="9e90c-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="9e90c-106">Si vous commencez tout juste à utiliser Office scripts avec Power Automate, veuillez commencer par exécuter des scripts Office avec des Power Automate pour en apprendre davantage sur les [plateformes.](../develop/power-automate-integration.md)</span><span class="sxs-lookup"><span data-stu-id="9e90c-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-relative-references"></a><span data-ttu-id="9e90c-107">Éviter les références relatives</span><span class="sxs-lookup"><span data-stu-id="9e90c-107">Avoid relative references</span></span>

<span data-ttu-id="9e90c-108">Power Automate exécute votre script dans le cahier de travail Excel choisi en votre nom.</span><span class="sxs-lookup"><span data-stu-id="9e90c-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="9e90c-109">Le cahier de travail peut être fermé lorsque cela se produit.</span><span class="sxs-lookup"><span data-stu-id="9e90c-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="9e90c-110">Toute API qui s’appuie sur l’état actuel de l’utilisateur, `Workbook.getActiveWorksheet` par exemple, peut se comporter différemment dans Power Automate.</span><span class="sxs-lookup"><span data-stu-id="9e90c-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="9e90c-111">C’est parce que les API sont basées sur une position relative de la vue ou du curseur de l’utilisateur et que cette référence n’existe pas dans un flux Power Automate utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9e90c-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="9e90c-112">Certaines API de référence relative jettent des erreurs dans Power Automate.</span><span class="sxs-lookup"><span data-stu-id="9e90c-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="9e90c-113">D’autres ont un comportement par défaut qui implique l’état d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9e90c-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="9e90c-114">Lors de la conception de vos scripts, assurez-vous d’utiliser des références absolues pour les feuilles de travail et les plages.</span><span class="sxs-lookup"><span data-stu-id="9e90c-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="9e90c-115">Cela rend votre Power Automate de débit constant, même si les feuilles de travail sont réarrangées.</span><span class="sxs-lookup"><span data-stu-id="9e90c-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-power-automate-flows"></a><span data-ttu-id="9e90c-116">Méthodes de script qui échouent lorsqu’elles sont Power Automate flux</span><span class="sxs-lookup"><span data-stu-id="9e90c-116">Script methods that fail when run Power Automate flows</span></span>

<span data-ttu-id="9e90c-117">Les méthodes suivantes lanceront une erreur et échoueront lorsqu’elles sont appelées à partir d’un script dans Power Automate flux.</span><span class="sxs-lookup"><span data-stu-id="9e90c-117">The following methods will throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="9e90c-118">Classe</span><span class="sxs-lookup"><span data-stu-id="9e90c-118">Class</span></span> | <span data-ttu-id="9e90c-119">Méthode</span><span class="sxs-lookup"><span data-stu-id="9e90c-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="9e90c-120">Graphique</span><span class="sxs-lookup"><span data-stu-id="9e90c-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="9e90c-121">Range</span><span class="sxs-lookup"><span data-stu-id="9e90c-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="9e90c-122">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="9e90c-123">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="9e90c-124">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="9e90c-125">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="9e90c-126">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="9e90c-127">Méthodes de script avec un comportement par défaut dans Power Automate flux</span><span class="sxs-lookup"><span data-stu-id="9e90c-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="9e90c-128">Les méthodes suivantes utilisent un comportement par défaut, au lieu de l’état actuel de tout utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9e90c-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="9e90c-129">Classe</span><span class="sxs-lookup"><span data-stu-id="9e90c-129">Class</span></span> | <span data-ttu-id="9e90c-130">Méthode</span><span class="sxs-lookup"><span data-stu-id="9e90c-130">Method</span></span> | <span data-ttu-id="9e90c-131">Power Automate comportement</span><span class="sxs-lookup"><span data-stu-id="9e90c-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="9e90c-132">Classeur</span><span class="sxs-lookup"><span data-stu-id="9e90c-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="9e90c-133">Renvoie soit la première feuille de travail dans le cahier de travail, soit la feuille de travail actuellement activée par la `Worksheet.activate` méthode.</span><span class="sxs-lookup"><span data-stu-id="9e90c-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="9e90c-134">Feuille de calcul</span><span class="sxs-lookup"><span data-stu-id="9e90c-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="9e90c-135">Marque la feuille de travail comme la feuille de travail active aux fins de `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="9e90c-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="9e90c-136">Sélectionnez des cahiers de travail avec le contrôle du navigateur de fichiers</span><span class="sxs-lookup"><span data-stu-id="9e90c-136">Select workbooks with the file browser control</span></span>

<span data-ttu-id="9e90c-137">Lors de la **création de l’étape** de script Exécuter Power Automate flux de flux, vous devez sélectionner quel manuel fait partie du flux.</span><span class="sxs-lookup"><span data-stu-id="9e90c-137">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="9e90c-138">Utilisez le navigateur de fichiers pour sélectionner votre cahier de travail, au lieu de taper manuellement le nom du livre de travail.</span><span class="sxs-lookup"><span data-stu-id="9e90c-138">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="L’action Power Automate exécuter le script montrant l’option de navigateur de fichiers Show Picker":::

<span data-ttu-id="9e90c-140">Pour plus de contexte sur la limitation Power Automate et une discussion des solutions de contournement potentielles pour la sélection dynamique des cahiers de travail, voir [ce fil dans le microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span><span class="sxs-lookup"><span data-stu-id="9e90c-140">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="9e90c-141">Différences de fuseau horaire</span><span class="sxs-lookup"><span data-stu-id="9e90c-141">Time zone differences</span></span>

<span data-ttu-id="9e90c-142">Excel fichiers n’ont pas d’emplacement ou de fuseau horaire inhérent.</span><span class="sxs-lookup"><span data-stu-id="9e90c-142">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="9e90c-143">Chaque fois qu’un utilisateur ouvre le cahier de travail, sa session utilise le fuseau horaire local de cet utilisateur pour les calculs de date.</span><span class="sxs-lookup"><span data-stu-id="9e90c-143">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="9e90c-144">Power Automate utilise toujours UTC.</span><span class="sxs-lookup"><span data-stu-id="9e90c-144">Power Automate always uses UTC.</span></span>

<span data-ttu-id="9e90c-145">Si votre script utilise des dates ou des heures, il peut y avoir des différences comportementales lorsque le script est testé localement par rapport à quand il est exécuté à travers Power Automate.</span><span class="sxs-lookup"><span data-stu-id="9e90c-145">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="9e90c-146">Power Automate vous permet de convertir, formater et ajuster les temps.</span><span class="sxs-lookup"><span data-stu-id="9e90c-146">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="9e90c-147">Voir [Travailler avec les dates et les heures à l’intérieur de vos](https://flow.microsoft.com/blog/working-with-dates-and-times/) flux pour obtenir des instructions sur la façon d’utiliser ces fonctions dans Power Automate et paramètres : [ `main` transmettez des](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) données à un script pour apprendre à fournir ces informations de temps pour le script.</span><span class="sxs-lookup"><span data-stu-id="9e90c-147">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Pass data to a script](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="9e90c-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9e90c-148">See also</span></span>

- [<span data-ttu-id="9e90c-149">Scripts de Office dépannage</span><span class="sxs-lookup"><span data-stu-id="9e90c-149">Troubleshoot Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="9e90c-150">Exécutez Office scripts avec Power Automate</span><span class="sxs-lookup"><span data-stu-id="9e90c-150">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="9e90c-151">Excel Documentation de référence connecteur en ligne (Business)</span><span class="sxs-lookup"><span data-stu-id="9e90c-151">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
