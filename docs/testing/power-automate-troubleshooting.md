---
title: Informations de dépannage pour Power Automate avec les scripts Office
description: Conseils, informations sur la plateforme et problèmes connus avec l'intégration entre Office Scripts et Power Automate.
ms.date: 01/14/2021
localization_priority: Normal
ms.openlocfilehash: 59f4cd8b3476c2ee2a1a862f136173a543ba8a15
ms.sourcegitcommit: 45ffe3dbd2c834b78592ad35928cf8096f5e80bc
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2021
ms.locfileid: "51755006"
---
# <a name="troubleshooting-information-for-power-automate-with-office-scripts"></a><span data-ttu-id="3d272-103">Informations de dépannage pour Power Automate avec les scripts Office</span><span class="sxs-lookup"><span data-stu-id="3d272-103">Troubleshooting information for Power Automate with Office Scripts</span></span>

<span data-ttu-id="3d272-104">Power Automate vous permet d'aller au niveau suivant de votre automatisation de script Office.</span><span class="sxs-lookup"><span data-stu-id="3d272-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="3d272-105">Toutefois, étant donné que Power Automate exécute des scripts en votre nom dans des sessions Excel indépendantes, il existe quelques points importants à noter.</span><span class="sxs-lookup"><span data-stu-id="3d272-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="3d272-106">Si vous commencez à utiliser les scripts Office avec Power Automate, commencez par exécuter [des scripts Office](../develop/power-automate-integration.md) avec Power Automate pour en savoir plus sur les plateformes.</span><span class="sxs-lookup"><span data-stu-id="3d272-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-using-relative-references"></a><span data-ttu-id="3d272-107">Éviter d'utiliser des références relatives</span><span class="sxs-lookup"><span data-stu-id="3d272-107">Avoid using relative references</span></span>

<span data-ttu-id="3d272-108">Power Automate exécute votre script dans le workbook Excel choisi en votre nom.</span><span class="sxs-lookup"><span data-stu-id="3d272-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="3d272-109">Le workbook peut être fermé lorsque cela se produit.</span><span class="sxs-lookup"><span data-stu-id="3d272-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="3d272-110">Toute API qui repose sur l'état actuel de l'utilisateur, par exemple, peut se comporter `Workbook.getActiveWorksheet` différemment dans Power Automate.</span><span class="sxs-lookup"><span data-stu-id="3d272-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="3d272-111">Cela est dû au fait que les API sont basées sur une position relative de l'affichage ou du curseur de l'utilisateur et que cette référence n'existe pas dans un flux Power Automate.</span><span class="sxs-lookup"><span data-stu-id="3d272-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="3d272-112">Certaines API de référence relative permettent de créer des erreurs dans Power Automate.</span><span class="sxs-lookup"><span data-stu-id="3d272-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="3d272-113">D'autres ont un comportement par défaut qui implique l'état d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3d272-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="3d272-114">Lors de la conception de vos scripts, n'oubliez pas d'utiliser des références absolues pour les feuilles de calcul et les plages.</span><span class="sxs-lookup"><span data-stu-id="3d272-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="3d272-115">Votre flux Power Automate est ainsi cohérent, même si les feuilles de calcul sont réorganiser.</span><span class="sxs-lookup"><span data-stu-id="3d272-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-power-automate-flows"></a><span data-ttu-id="3d272-116">Méthodes de script qui échouent lors de l'exécuter des flux Power Automate</span><span class="sxs-lookup"><span data-stu-id="3d272-116">Script methods that fail when run Power Automate flows</span></span>

<span data-ttu-id="3d272-117">Les méthodes suivantes lancent une erreur et échouent lorsqu'elles sont appelées à partir d'un script dans un flux Power Automate.</span><span class="sxs-lookup"><span data-stu-id="3d272-117">The following methods will throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="3d272-118">Classe</span><span class="sxs-lookup"><span data-stu-id="3d272-118">Class</span></span> | <span data-ttu-id="3d272-119">Méthode</span><span class="sxs-lookup"><span data-stu-id="3d272-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="3d272-120">Chart</span><span class="sxs-lookup"><span data-stu-id="3d272-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="3d272-121">Range</span><span class="sxs-lookup"><span data-stu-id="3d272-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="3d272-122">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="3d272-123">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="3d272-124">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="3d272-125">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="3d272-126">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="3d272-127">Méthodes de script avec un comportement par défaut dans les flux Power Automate</span><span class="sxs-lookup"><span data-stu-id="3d272-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="3d272-128">Les méthodes suivantes utilisent un comportement par défaut, à la place de l'état actuel de n'importe quel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3d272-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="3d272-129">Classe</span><span class="sxs-lookup"><span data-stu-id="3d272-129">Class</span></span> | <span data-ttu-id="3d272-130">Méthode</span><span class="sxs-lookup"><span data-stu-id="3d272-130">Method</span></span> | <span data-ttu-id="3d272-131">Comportement de Power Automate</span><span class="sxs-lookup"><span data-stu-id="3d272-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="3d272-132">Workbook</span><span class="sxs-lookup"><span data-stu-id="3d272-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="3d272-133">Renvoie la première feuille de calcul du manuel ou la feuille de calcul actuellement activée par la `Worksheet.activate` méthode.</span><span class="sxs-lookup"><span data-stu-id="3d272-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="3d272-134">Worksheet</span><span class="sxs-lookup"><span data-stu-id="3d272-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="3d272-135">Marque la feuille de calcul comme feuille de calcul active à des fins de `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="3d272-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="3d272-136">Sélectionner des classes avec le contrôle de navigateur de fichiers</span><span class="sxs-lookup"><span data-stu-id="3d272-136">Select workbooks with the file browser control</span></span>

<span data-ttu-id="3d272-137">Lorsque vous **construisez l'étape du script** Exécuter d'un flux Power Automate, vous devez sélectionner le workbook qui fait partie du flux.</span><span class="sxs-lookup"><span data-stu-id="3d272-137">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="3d272-138">Utilisez le navigateur de fichiers pour sélectionner votre classez, au lieu de taper manuellement le nom du classer.</span><span class="sxs-lookup"><span data-stu-id="3d272-138">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="Action de script Exécuter Power Automate montrant l'option Afficher le navigateur du fichier du s picker.":::

<span data-ttu-id="3d272-140">Pour plus de contexte sur la limitation De Power Automate et une discussion sur les solutions de contournement potentielles pour la sélection dynamique de workbooks, voir ce thread dans la [communauté Microsoft Power Automate](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span><span class="sxs-lookup"><span data-stu-id="3d272-140">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="3d272-141">Différences de fuseau horaire</span><span class="sxs-lookup"><span data-stu-id="3d272-141">Time zone differences</span></span>

<span data-ttu-id="3d272-142">Les fichiers Excel n'ont pas d'emplacement ou de fuseau horaire inhérents.</span><span class="sxs-lookup"><span data-stu-id="3d272-142">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="3d272-143">Chaque fois qu'un utilisateur ouvre le manuel, sa session utilise le fuseau horaire local de cet utilisateur pour les calculs de date.</span><span class="sxs-lookup"><span data-stu-id="3d272-143">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="3d272-144">Power Automate utilise toujours l'UTC.</span><span class="sxs-lookup"><span data-stu-id="3d272-144">Power Automate always uses UTC.</span></span>

<span data-ttu-id="3d272-145">Si votre script utilise des dates ou des heures, il peut y avoir des différences de comportement lorsque le script est testé localement par rapport au moment où il est exécuté via Power Automate.</span><span class="sxs-lookup"><span data-stu-id="3d272-145">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="3d272-146">Power Automate vous permet de convertir, de mettre en forme et d'ajuster les temps.</span><span class="sxs-lookup"><span data-stu-id="3d272-146">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="3d272-147">Consultez l'utilisation de [dates](https://flow.microsoft.com/blog/working-with-dates-and-times/) et d'heures dans vos flux pour obtenir des instructions sur l'utilisation de ces fonctions dans Power Automate et [ `main` paramètres](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) : transmettre des données à un script pour découvrir comment fournir ces informations d'heure pour le script.</span><span class="sxs-lookup"><span data-stu-id="3d272-147">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Passing data to a script](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="3d272-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3d272-148">See also</span></span>

- [<span data-ttu-id="3d272-149">Dépannage de Office Scripts</span><span class="sxs-lookup"><span data-stu-id="3d272-149">Troubleshooting Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="3d272-150">Exécuter des scripts Office avec Power Automate</span><span class="sxs-lookup"><span data-stu-id="3d272-150">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="3d272-151">Documentation de référence sur le connecteur Excel Online (Entreprise)</span><span class="sxs-lookup"><span data-stu-id="3d272-151">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
