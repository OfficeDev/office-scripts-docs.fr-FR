---
title: Résoudre les problèmes Office scripts en cours d’exécution dans Power Automate
description: Astuces, les informations de plateforme et les problèmes connus avec l’intégration entre Office scripts et Power Automate.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 7ba128314c0d632a3e77792b7ee545bfb7dca71d
ms.sourcegitcommit: 4693c8f79428ec74695328275703af0ba1bfea8f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53074633"
---
# <a name="troubleshoot-office-scripts-running-in-power-automate"></a><span data-ttu-id="0ded0-103">Résoudre les problèmes Office scripts en cours d’exécution dans Power Automate</span><span class="sxs-lookup"><span data-stu-id="0ded0-103">Troubleshoot Office Scripts running in Power Automate</span></span>

<span data-ttu-id="0ded0-104">Power Automate vous permet d’Office l’automatisation des scripts au niveau suivant.</span><span class="sxs-lookup"><span data-stu-id="0ded0-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="0ded0-105">Toutefois, comme Power Automate exécute des scripts en votre nom dans des sessions Excel indépendantes, il existe quelques points importants à noter.</span><span class="sxs-lookup"><span data-stu-id="0ded0-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="0ded0-106">Si vous débutez avec Office Scripts avec Power Automate, commencez par Exécuter [des scripts Office](../develop/power-automate-integration.md) avec Power Automate pour en savoir plus sur les plateformes.</span><span class="sxs-lookup"><span data-stu-id="0ded0-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-relative-references"></a><span data-ttu-id="0ded0-107">Éviter les références relatives</span><span class="sxs-lookup"><span data-stu-id="0ded0-107">Avoid relative references</span></span>

<span data-ttu-id="0ded0-108">Power Automate exécute votre script dans le Excel de travail choisi en votre nom.</span><span class="sxs-lookup"><span data-stu-id="0ded0-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="0ded0-109">Le workbook peut être fermé lorsque cela se produit.</span><span class="sxs-lookup"><span data-stu-id="0ded0-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="0ded0-110">Toute API qui repose sur l’état actuel de l’utilisateur, par exemple, peut se comporter différemment dans `Workbook.getActiveWorksheet` Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0ded0-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="0ded0-111">Cela est dû au fait que les API sont basées sur une position relative de l’affichage ou du curseur de l’utilisateur et que cette référence n’existe pas dans Power Automate flux.</span><span class="sxs-lookup"><span data-stu-id="0ded0-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="0ded0-112">Certaines API de référence relative envoient des erreurs Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0ded0-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="0ded0-113">D’autres ont un comportement par défaut qui implique l’état d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0ded0-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="0ded0-114">Lors de la conception de vos scripts, n’oubliez pas d’utiliser des références absolues pour les feuilles de calcul et les plages.</span><span class="sxs-lookup"><span data-stu-id="0ded0-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="0ded0-115">Cela permet à votre Power Automate un flux cohérent, même si les feuilles de calcul sont réorganiser.</span><span class="sxs-lookup"><span data-stu-id="0ded0-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-in-power-automate-flows"></a><span data-ttu-id="0ded0-116">Méthodes de script qui échouent lors de l’Power Automate flux</span><span class="sxs-lookup"><span data-stu-id="0ded0-116">Script methods that fail when run in Power Automate flows</span></span>

<span data-ttu-id="0ded0-117">Les méthodes suivantes envoient une erreur et échouent lorsqu’elles sont appelées à partir d’un script dans Power Automate flux.</span><span class="sxs-lookup"><span data-stu-id="0ded0-117">The following methods throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="0ded0-118">Classe</span><span class="sxs-lookup"><span data-stu-id="0ded0-118">Class</span></span> | <span data-ttu-id="0ded0-119">Méthode</span><span class="sxs-lookup"><span data-stu-id="0ded0-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="0ded0-120">Graphique</span><span class="sxs-lookup"><span data-stu-id="0ded0-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="0ded0-121">Range</span><span class="sxs-lookup"><span data-stu-id="0ded0-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="0ded0-122">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="0ded0-123">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="0ded0-124">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="0ded0-125">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="0ded0-126">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="0ded0-127">Méthodes de script avec un comportement par défaut dans Power Automate flux</span><span class="sxs-lookup"><span data-stu-id="0ded0-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="0ded0-128">Les méthodes suivantes utilisent un comportement par défaut, à la place de l’état actuel de n’importe quel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0ded0-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="0ded0-129">Classe</span><span class="sxs-lookup"><span data-stu-id="0ded0-129">Class</span></span> | <span data-ttu-id="0ded0-130">Méthode</span><span class="sxs-lookup"><span data-stu-id="0ded0-130">Method</span></span> | <span data-ttu-id="0ded0-131">Power Automate comportement</span><span class="sxs-lookup"><span data-stu-id="0ded0-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="0ded0-132">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="0ded0-133">Renvoie la première feuille de calcul du manuel ou la feuille de calcul actuellement activée par la `Worksheet.activate` méthode.</span><span class="sxs-lookup"><span data-stu-id="0ded0-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="0ded0-134">Feuille de calcul</span><span class="sxs-lookup"><span data-stu-id="0ded0-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="0ded0-135">Marque la feuille de calcul en tant que feuille de calcul active à des fins de `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="0ded0-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="data-refresh-not-supported-in-power-automate"></a><span data-ttu-id="0ded0-136">L’actualisation des données n’est pas prise en charge dans Power Automate</span><span class="sxs-lookup"><span data-stu-id="0ded0-136">Data refresh not supported in Power Automate</span></span>

<span data-ttu-id="0ded0-137">Office Les scripts ne peuvent pas actualiser les données lorsqu’ils sont exécutés Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0ded0-137">Office Scripts can't refresh data when run in Power Automate.</span></span> <span data-ttu-id="0ded0-138">Méthodes telles que `PivotTable.refresh` ne rien faire lorsqu’elles sont appelées dans un flux.</span><span class="sxs-lookup"><span data-stu-id="0ded0-138">Methods such as `PivotTable.refresh` do nothing when called in a flow.</span></span> <span data-ttu-id="0ded0-139">En outre, Power Automate ne déclenche pas d’actualisation des données pour les formules qui utilisent des liens de workbook.</span><span class="sxs-lookup"><span data-stu-id="0ded0-139">Additionally, Power Automate doesn't trigger a data refresh for formulas that use workbook links.</span></span>

### <a name="script-methods-that-do-nothing-when-run-in-power-automate-flows"></a><span data-ttu-id="0ded0-140">Méthodes de script qui ne font rien lorsqu’elles sont Power Automate flux</span><span class="sxs-lookup"><span data-stu-id="0ded0-140">Script methods that do nothing when run in Power Automate flows</span></span>

<span data-ttu-id="0ded0-141">Les méthodes suivantes ne font rien dans un script lorsqu’elles sont appelées Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0ded0-141">The following methods do nothing in a script when called through Power Automate.</span></span> <span data-ttu-id="0ded0-142">Elles sont toujours correctement renvoy es et ne lancent pas d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="0ded0-142">They still return successfully and don't throw any errors.</span></span>

| <span data-ttu-id="0ded0-143">Classe</span><span class="sxs-lookup"><span data-stu-id="0ded0-143">Class</span></span> | <span data-ttu-id="0ded0-144">Méthode</span><span class="sxs-lookup"><span data-stu-id="0ded0-144">Method</span></span> |
|--|--|
| [<span data-ttu-id="0ded0-145">PivotTable</span><span class="sxs-lookup"><span data-stu-id="0ded0-145">PivotTable</span></span>](/javascript/api/office-scripts/excelscript/excelscript.pivottable) | `refresh` |
| [<span data-ttu-id="0ded0-146">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-146">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllDataConnections` |
| [<span data-ttu-id="0ded0-147">Classeur</span><span class="sxs-lookup"><span data-stu-id="0ded0-147">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllPivotTables` |
| [<span data-ttu-id="0ded0-148">Feuille de calcul</span><span class="sxs-lookup"><span data-stu-id="0ded0-148">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `refreshAllPivotTables` |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="0ded0-149">Sélectionner des classes avec le contrôle de navigateur de fichiers</span><span class="sxs-lookup"><span data-stu-id="0ded0-149">Select workbooks with the file browser control</span></span>

<span data-ttu-id="0ded0-150">Lors de la création **de l’étape** d’Power Automate script d’un flux d’Power Automate, vous devez sélectionner le workbook qui fait partie du flux.</span><span class="sxs-lookup"><span data-stu-id="0ded0-150">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="0ded0-151">Utilisez le navigateur de fichiers pour sélectionner votre classez, au lieu de taper manuellement le nom du classer.</span><span class="sxs-lookup"><span data-stu-id="0ded0-151">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="L’Power Automate exécuter une action de script montrant l’option Afficher le navigateur de fichier du s picker.":::

<span data-ttu-id="0ded0-153">Pour plus de contexte sur la limitation Power Automate et une discussion sur les solutions de contournement potentielles pour la sélection dynamique de workbooks, voir ce thread dans le microsoft [Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span><span class="sxs-lookup"><span data-stu-id="0ded0-153">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="0ded0-154">Différences de fuseau horaire</span><span class="sxs-lookup"><span data-stu-id="0ded0-154">Time zone differences</span></span>

<span data-ttu-id="0ded0-155">Excel fichiers n’ont pas d’emplacement ou de fuseau horaire inhérents.</span><span class="sxs-lookup"><span data-stu-id="0ded0-155">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="0ded0-156">Chaque fois qu’un utilisateur ouvre le manuel, sa session utilise le fuseau horaire local de cet utilisateur pour les calculs de date.</span><span class="sxs-lookup"><span data-stu-id="0ded0-156">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="0ded0-157">Power Automate utilise toujours l’UTC.</span><span class="sxs-lookup"><span data-stu-id="0ded0-157">Power Automate always uses UTC.</span></span>

<span data-ttu-id="0ded0-158">Si votre script utilise des dates ou des heures, il peut y avoir des différences de comportement lorsque le script est testé localement par rapport au moment où il est exécuté Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0ded0-158">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="0ded0-159">Power Automate vous permet de convertir, de mettre en forme et d’ajuster les temps.</span><span class="sxs-lookup"><span data-stu-id="0ded0-159">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="0ded0-160">Voir [Utilisation](https://flow.microsoft.com/blog/working-with-dates-and-times/) des dates et heures à l’intérieur de vos flux pour obtenir des instructions sur l’utilisation de ces fonctions dans Power Automate and [ `main` Parameters: Pass data to a script to](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) learn how to provide that time information for the script.</span><span class="sxs-lookup"><span data-stu-id="0ded0-160">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Pass data to a script](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="0ded0-161">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0ded0-161">See also</span></span>

- [<span data-ttu-id="0ded0-162">Résoudre les problèmes Office scripts</span><span class="sxs-lookup"><span data-stu-id="0ded0-162">Troubleshoot Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="0ded0-163">Exécuter Office scripts avec Power Automate</span><span class="sxs-lookup"><span data-stu-id="0ded0-163">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="0ded0-164">Excel Documentation de référence sur le connecteur en ligne (Entreprise)</span><span class="sxs-lookup"><span data-stu-id="0ded0-164">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
