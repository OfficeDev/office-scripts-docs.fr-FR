---
title: Différences entre Office scripts et macros VBA
description: Les différences de comportement et d’API entre Office scripts et Excel macros VBA.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 612a5f21d935fd262a6e9fd12a3431956105636a
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545587"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="245c5-103">Différences entre Office scripts et macros VBA</span><span class="sxs-lookup"><span data-stu-id="245c5-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="245c5-104">Office Les scripts et les macros VBA ont beaucoup en commun.</span><span class="sxs-lookup"><span data-stu-id="245c5-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="245c5-105">Ils permettent tous deux aux utilisateurs d’automatiser des solutions grâce à un enregistreur d’action facile à utiliser et permettent des modifications de ces enregistrements.</span><span class="sxs-lookup"><span data-stu-id="245c5-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="245c5-106">Les deux cadres sont conçus pour permettre aux personnes qui ne se considèrent peut-être pas comme des programmeurs de créer de petits programmes Excel.</span><span class="sxs-lookup"><span data-stu-id="245c5-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="245c5-107">La différence fondamentale est que les macros VBA sont développées pour les solutions de bureau et Office scripts sont conçus pour des solutions sécurisées basées sur le cloud.</span><span class="sxs-lookup"><span data-stu-id="245c5-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed for secure, cloud-based solutions.</span></span> <span data-ttu-id="245c5-108">Actuellement, les Office sont pris en charge uniquement dans Excel sur le Web.</span><span class="sxs-lookup"><span data-stu-id="245c5-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Un diagramme à quatre quadrants montrant les domaines d’intérêt pour différentes solutions Office’extensibilité. Les Office scripts et les macros VBA sont conçus pour aider les utilisateurs finaux à créer des solutions, mais les scripts Office sont conçus pour le Web et la collaboration (alors que VBA est pour le bureau)":::

<span data-ttu-id="245c5-110">Cet article décrit les principales différences entre les macros VBA (ainsi que VBA en général) et les scripts Office.</span><span class="sxs-lookup"><span data-stu-id="245c5-110">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="245c5-111">Puisque Office scripts ne sont disponibles que pour Excel, c’est le seul hôte en discussion ici.</span><span class="sxs-lookup"><span data-stu-id="245c5-111">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="245c5-112">Plate-forme et écosystème</span><span class="sxs-lookup"><span data-stu-id="245c5-112">Platform and ecosystem</span></span>

<span data-ttu-id="245c5-113">VBA est conçu pour le bureau et Office scripts sont conçus pour le Web.</span><span class="sxs-lookup"><span data-stu-id="245c5-113">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="245c5-114">VBA peut interagir avec le bureau d’un utilisateur pour se connecter à des technologies similaires, telles que COM et OLE.</span><span class="sxs-lookup"><span data-stu-id="245c5-114">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="245c5-115">Cependant, VBA n’a aucun moyen pratique d’appeler à l’Internet.</span><span class="sxs-lookup"><span data-stu-id="245c5-115">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="245c5-116">Office Les scripts utilisent un temps d’exécution universel pour JavaScript.</span><span class="sxs-lookup"><span data-stu-id="245c5-116">Office Scripts use a universal runtime for JavaScript.</span></span> <span data-ttu-id="245c5-117">Cela donne un comportement et une accessibilité cohérents, quelle que soit la machine utilisée pour exécuter le script.</span><span class="sxs-lookup"><span data-stu-id="245c5-117">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="245c5-118">Ils peuvent également passer des appels vers d’autres services Web.</span><span class="sxs-lookup"><span data-stu-id="245c5-118">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="245c5-119">Sécurité</span><span class="sxs-lookup"><span data-stu-id="245c5-119">Security</span></span>

<span data-ttu-id="245c5-120">Les macros VBA ont la même habilitation de sécurité que Excel.</span><span class="sxs-lookup"><span data-stu-id="245c5-120">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="245c5-121">Cela leur donne un accès complet à votre bureau.</span><span class="sxs-lookup"><span data-stu-id="245c5-121">This gives them full access to your desktop.</span></span> <span data-ttu-id="245c5-122">Office Les scripts n’ont accès qu’au cahier de travail, pas à la machine hébergeant le cahier de travail.</span><span class="sxs-lookup"><span data-stu-id="245c5-122">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="245c5-123">En outre, aucun jeton d’authentification JavaScript ne peut être partagé avec des scripts.</span><span class="sxs-lookup"><span data-stu-id="245c5-123">Additionally, no JavaScript authentication tokens can be shared with scripts.</span></span> <span data-ttu-id="245c5-124">Cela signifie que le script n’a ni les jetons de l’utilisateur connecté ni aucune capacité d’API pour se connecter à un service externe, de sorte qu’ils ne sont pas en mesure d’utiliser les jetons existants pour faire des appels externes au nom de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="245c5-124">This means the script has neither the tokens of the signed-in user nor are there any API capabilities for signing in to an external service, so they are unable to use existing tokens to make external calls on behalf of the user.</span></span>

<span data-ttu-id="245c5-125">Admins ont trois options pour les macros VBA: autoriser toutes les macros sur le locataire, ne pas autoriser de macros sur le locataire, ou ne permettre que des macros avec des certificats signés.</span><span class="sxs-lookup"><span data-stu-id="245c5-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="245c5-126">Ce manque de granularité rend difficile l’isolement d’un seul mauvais acteur.</span><span class="sxs-lookup"><span data-stu-id="245c5-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="245c5-127">Actuellement, Office scripts sont en cours ou en dehors pour un locataire.</span><span class="sxs-lookup"><span data-stu-id="245c5-127">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="245c5-128">Cependant, nous travaillons à donner aux administrateurs plus de contrôle sur les scripts individuels et les créateurs de scripts.</span><span class="sxs-lookup"><span data-stu-id="245c5-128">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="245c5-129">couverture</span><span class="sxs-lookup"><span data-stu-id="245c5-129">Coverage</span></span>

<span data-ttu-id="245c5-130">Actuellement, VBA offre une couverture plus complète des fonctionnalités Excel, en particulier celles disponibles sur le client de bureau.</span><span class="sxs-lookup"><span data-stu-id="245c5-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="245c5-131">Office Les scripts couvrent presque tous les scénarios pour Excel sur le Web.</span><span class="sxs-lookup"><span data-stu-id="245c5-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="245c5-132">En outre, comme de nouvelles fonctionnalités débutent sur le web, Office scripts les prendra en charge à la fois pour l’enregistreur d’action et les API JavaScript.</span><span class="sxs-lookup"><span data-stu-id="245c5-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

<span data-ttu-id="245c5-133">Office Les scripts ne supportent pas Excel événements de niveau [supérieur](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span><span class="sxs-lookup"><span data-stu-id="245c5-133">Office Scripts don't support Excel-level [events](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span></span> <span data-ttu-id="245c5-134">Les scripts ne sont exécutés que lorsqu’un utilisateur les démarre manuellement ou lorsqu’Power Automate flux d’utilisateurs appelle le script.</span><span class="sxs-lookup"><span data-stu-id="245c5-134">Scripts are only run when a user manually starts them or when a Power Automate flow calls the script.</span></span>

## <a name="power-automate"></a><span data-ttu-id="245c5-135">Power Automate</span><span class="sxs-lookup"><span data-stu-id="245c5-135">Power Automate</span></span>

<span data-ttu-id="245c5-136">Office Les scripts peuvent être exécutés à travers Power Automate.</span><span class="sxs-lookup"><span data-stu-id="245c5-136">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="245c5-137">Votre cahier de travail peut être mis à jour par des flux planifiés ou axés sur des événements, vous permettant d’automatiser les flux de travail sans même Excel.</span><span class="sxs-lookup"><span data-stu-id="245c5-137">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="245c5-138">Cela signifie que tant que votre cahier de travail est stocké en OneDrive (et accessible à Power Automate), un flux peut exécuter vos scripts, que vous et votre organisation utilisiez le bureau, le Mac ou le client Web de Excel.</span><span class="sxs-lookup"><span data-stu-id="245c5-138">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="245c5-139">VBA n’a pas de connecteur Power Automate système.</span><span class="sxs-lookup"><span data-stu-id="245c5-139">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="245c5-140">Tous les scénarios VBA pris en charge impliquent qu’un utilisateur s’occuper de l’exécution de la macro.</span><span class="sxs-lookup"><span data-stu-id="245c5-140">All supported VBA scenarios involve a user attending to the macro's execution.</span></span>

<span data-ttu-id="245c5-141">Essayez les [scripts d’appel à partir d’un Power Automate de flux](../tutorials/excel-power-automate-manual.md) manuel pour commencer à en apprendre davantage sur Power Automate.</span><span class="sxs-lookup"><span data-stu-id="245c5-141">Try the [Call scripts from a manual Power Automate flow](../tutorials/excel-power-automate-manual.md) tutorial to start learning about Power Automate.</span></span> <span data-ttu-id="245c5-142">Vous pouvez également consulter [l’exemple des rappels de tâches automatisés](scenarios/task-reminders.md) pour voir les scripts Office connectés à Teams à Power Automate dans un scénario réel.</span><span class="sxs-lookup"><span data-stu-id="245c5-142">You can also check out the [Automated task reminders](scenarios/task-reminders.md) sample to see Office Scripts connected to Teams through Power Automate in a real-world scenario.</span></span>

## <a name="see-also"></a><span data-ttu-id="245c5-143">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="245c5-143">See also</span></span>

- [<span data-ttu-id="245c5-144">Office Scripts dans Excel sur le web</span><span class="sxs-lookup"><span data-stu-id="245c5-144">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="245c5-145">Exécutez Office scripts avec Power Automate</span><span class="sxs-lookup"><span data-stu-id="245c5-145">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="245c5-146">Différences entre les scripts Office et les compléments Office</span><span class="sxs-lookup"><span data-stu-id="245c5-146">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="245c5-147">Dépannage de Office Scripts</span><span class="sxs-lookup"><span data-stu-id="245c5-147">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="245c5-148">Référence VBA Excel</span><span class="sxs-lookup"><span data-stu-id="245c5-148">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
